syntax = "proto2";
package tdrec.protos;

message FeatureConfig {
    repeated FeatureUnit features = 1;
}

message FeatureUnit {
    oneof feature {
        IdFeature id_feature = 1;
        RawFeature raw_feature = 2;
        SequenceFeature sequence_feature = 3;
        TagFeature tag_feature = 4;
    }
}

message IdFeature {
    required string input_name = 1;
    // feature input, e.g. item:item_id
    optional string feature_name = 2;
    // embedding dimension
    required uint32 embedding_dim = 4;
    // number of id enumerators
    optional uint32 num_buckets = 6;
}

message RawFeature {
    required string input_name = 1;
    // feature input, e.g. item:item_id
    optional string feature_name = 2;
     // raw feature of multiple dimensions
    optional uint32 value_dim = 6 [default = 1];
    // embedding dimension
    optional uint32 embedding_dim = 4 [default = 0];
}

message SequenceFeature {
    required string input_name = 1;
    // feature input, e.g. item:item_id
    optional string feature_name = 2;
    // embedding dimension
    required uint32 embedding_dim = 4;
    // number of id enumerators
    optional uint32 num_buckets = 6;
}

message TagFeature {
    required string input_name = 1;
    // feature input, e.g. item:item_id
    optional string feature_name = 2;
    // embedding dimension
    required uint32 embedding_dim = 4;
    // number of id enumerators
    optional uint32 num_buckets = 6;
    //
    optional Pooling pooling = 8;
}

enum Pooling {
    SUM = 1;
    MEAN = 2;
    MAX = 3;
}
